(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{166:function(t,e,s){t.exports=s.p+"assets/img/workflow.b5a41b85.png"},168:function(t,e,s){"use strict";s.r(e);var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"node-ts-bus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#node-ts-bus","aria-hidden":"true"}},[this._v("#")]),this._v(" @node-ts/bus")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("strong",[this._v("A service bus for message-based, distributed node applications.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"overview"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#overview","aria-hidden":"true"}},[this._v("#")]),this._v(" Overview")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("Your system, as a whole, can accept and process "),s("code",[t._v("commands")])]),t._v(" "),s("li",[t._v("When a command is executed, one or more "),s("code",[t._v("events")]),t._v(" are published")]),t._v(" "),s("li",[t._v("The system can listen for certain "),s("code",[t._v("events")]),t._v(" and trigger other "),s("code",[t._v("commands")]),t._v(" because of it")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("A "),s("code",[t._v("command")]),t._v(" like "),s("code",[t._v("ReserveRoom")]),t._v(" is sent when a new reservation is made")]),t._v(" "),s("li",[t._v("Upon processing this "),s("code",[t._v("command")]),t._v(", a "),s("code",[t._v("RoomReserved")]),t._v(" event is published")]),t._v(" "),s("li",[t._v("Whenever a "),s("code",[t._v("RoomReserved")]),t._v(" "),s("code",[t._v("event")]),t._v(" is received, a "),s("code",[t._v("SendEmailToHotel")]),t._v(" "),s("code",[t._v("command")]),t._v(" is sent")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"components"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#components","aria-hidden":"true"}},[this._v("#")]),this._v(" Components")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"message-handlers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#message-handlers","aria-hidden":"true"}},[this._v("#")]),this._v(" Message Handlers")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Here's a simple message handler. Just declare a class that "),e("code",[this._v("HandlesMessage")]),this._v(", and this framework will automatically take care of configuring the underlying message transport so that your app receives these messages regardless of where it's sent from.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[t._v("@"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("HandlesMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ReserveRoom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReserveRoomHandler")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handles")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ReserveRoom"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    roomService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reserve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"workflows"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#workflows","aria-hidden":"true"}},[this._v("#")]),this._v(" Workflows")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Workflows are crucial in decoupling your application and keeping the "),e("em",[e("strong",[this._v("how to do something")])]),this._v(" separate from the "),e("em",[e("strong",[this._v("when to do something")])]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(166),alt:"Room Reservation Workflow"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-typescript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-typescript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReservationWorkflow")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Workflow")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ReservationWorkflowData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("constructor")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("@"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("inject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BUS_SYMBOLS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Bus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" bus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Bus")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n   * Start a new ReservationWorkflow each time a `RoomReserved` event is published\n   */")]),t._v("\n  @StartedBy"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("RoomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ReservationWorkflowData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'handleRoomReserved'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RoomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleRoomReserved")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("roomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" RoomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Partial"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ReservationWorkflowData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Notify the hotel that the room was reserved")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" notifyHotel "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SendEmailToHotel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      roomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("roomId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      roomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("fromDate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      roomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("toDate\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("notifyHotel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Add the room id to the workflow state")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      customerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" roomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      roomId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" roomReserved"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("roomId\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n   * Once the email has been sent to the hotel notifying them of the booking, send the\n   * itinerary to the customer.\n   */")]),t._v("\n  @Handles"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("EmailSentToHotel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ReservationWorkflowData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'handleEmailSentToHotel'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EmailSentToHotel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("event")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("roomId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'roomId'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleEmailSentToHotel")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("event"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" EmailSentToHotel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ReservationWorkflowData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Promise")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Partial"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("ReservationWorkflowData"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// The current workflow state is injected into each handler")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" sendItineraryToCustomer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SendItineraryToCustomer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("customerId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("roomId\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bus"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sendItineraryToCustomer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Nothing left to do for this workfow, so mark it as complete")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeWorkflow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"transports"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#transports","aria-hidden":"true"}},[this._v("#")]),this._v(" Transports")])}],n=s(0),r=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("p",[s("a",{attrs:{href:"https://greenkeeper.io/",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://badges.greenkeeper.io/node-ts/bus.svg",alt:"Greenkeeper badge"}}),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://circleci.com/gh/node-ts/bus/tree/master",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://circleci.com/gh/node-ts/bus/tree/master.svg?style=svg",alt:"CircleCI"}}),s("OutboundLink")],1),s("a",{attrs:{href:"https://opensource.org/licenses/MIT",target:"_blank",rel:"noopener noreferrer"}},[s("img",{attrs:{src:"https://img.shields.io/badge/License-MIT-green.svg",alt:"License: MIT"}}),s("OutboundLink")],1),t._v(" "),s("iframe",{attrs:{src:"https://ghbtns.com/github-btn.html?user=node-ts&repo=bus&type=star&count=true",frameborder:"0",scrolling:"0",width:"80px",height:"20px"}}),t._v(" "),s("iframe",{attrs:{src:"https://ghbtns.com/github-btn.html?user=node-ts&repo=bus&type=watch&count=true&v=2",frameborder:"0",scrolling:"0",width:"170px",height:"20px"}})]),t._v(" "),s("p",[t._v("View our docs at "),s("a",{attrs:{href:"https://node-ts.github.io/bus/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://node-ts.github.io/bus/"),s("OutboundLink")],1)]),t._v(" "),t._m(2),t._v(" "),s("p",[t._v("This framework provides a way to connect different applications or parts of the same application together in a developer-friendly way powered by message queues. It helps to decouple and greatly simplify applications, especially as they grow larger.")]),t._v(" "),s("p",[t._v("The simplest way to imagine a message based system is the following:")]),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("For example consider an online hotel booking message based system:")]),t._v(" "),t._m(4),t._v(" "),s("p",[t._v("This library can be combined with the Domain Driven Design library "),s("a",{attrs:{href:"https://www.github.com/node-ts/ddd",target:"_blank",rel:"noopener noreferrer"}},[t._v("@node-ts/ddd"),s("OutboundLink")],1),t._v(" that helps align software with the business domain.")]),t._v(" "),t._m(5),t._v(" "),s("p",[t._v("This library consists of the following main components:")]),t._v(" "),t._m(6),t._v(" "),s("p",[t._v("Message handlers are simple, stateless functions that are invoked each time a message that your application subscribes to is received. They take the message as an argument, perform an action based on the message, and then complete.")]),t._v(" "),t._m(7),t._v(" "),t._m(8),s("p",[t._v("For more information on handlers, see "),s("router-link",{attrs:{to:"./packages/bus-core/src/handler/"}},[t._v("@node-ts/bus-core/handlers")])],1),t._v(" "),s("p",[t._v("For more information on message types, see "),s("router-link",{attrs:{to:"./packages/bus-messages/"}},[t._v("@node-ts/bus-messages")])],1),t._v(" "),t._m(9),t._v(" "),s("p",[t._v("Workflows orchestrate the business process logic in your application. Business processes are specific to your application and problem domain, and can be anything from carrying out the steps of an eCommerce site to process an order through to fulfilment, to managing a marketing campaign from start to finish.")]),t._v(" "),t._m(10),t._v(" "),s("p",[t._v("Consider the following business process that sends emails to the hotel, and then the customer when a hotel room is reserved:")]),t._v(" "),t._m(11),t._v(" "),s("p",[t._v("Writing this process as a workflow is simple and resilient:")]),t._v(" "),t._m(12),s("p",[t._v("This workflow coordinates a number of different systems without any knowledge of where they are or how they work. It does no work except to orchestrate individual actions (commands) to perform a larger process.")]),t._v(" "),s("p",[t._v("For more information, see "),s("router-link",{attrs:{to:"/packages/bus-workflow/"}},[t._v("@node-ts/bus-workflow")])],1),t._v(" "),t._m(13),t._v(" "),s("p",[t._v("Transports are message brokers that are use by this library for communication. RabbitMQ, AWS SQS, Kafka, MSMQ etc are all examples of message queueing technology that can be used. The choice of transport is largely irrelevant for the developer, as this library abstracts all of those complexities away.")]),t._v(" "),s("p",[t._v("Currently transport adapters for RabbitMQ and AWS SQS have been written, but implementing one for a different technology is simple.")]),t._v(" "),s("p",[t._v("For more information, see "),s("router-link",{attrs:{to:"/packages/bus-core/src/transport/"}},[t._v("@node-ts/bus-core/transport")])],1)])},a,!1,null,null,null);e.default=r.exports}}]);